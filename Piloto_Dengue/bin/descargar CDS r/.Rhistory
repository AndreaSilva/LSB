for(j in 1:nrow(table)){
frec <- sum(table[j,])
for(i in 1:nrow(table1)){
lonv <- sum(table1[i,1])
commonk[j,i] <- log10(0.1 + frec[j]/(lonv[i]-2))
}
}
return(commonk)
}
Fraccional_common <- Fractional(salida,min_lon)
View(Fraccional_common)
log10(0.1 + sum(salida[1,]/(min_lon[1,1]-2)))
Fractional <- function(table,table1,k=3){
commonk<- data.frame()
for(j in 1:nrow(table)){
for(i in 1:nrow(table1)){
commonk[j,i] <- (log10(0.1 + sum(table[j,]/(table1[i,1]-2))))
}
}
return(commonk)
}
Fraccional_common <- Fractional(salida,min_lon)
Fractional <- function(table, table1, k=3){
commonk <- data.frame()
frec <- vector()
lonv <- vector()
for(j in 1:nrow(table)){
frec <- sum(table[j,])
for(i in 1:nrow(table1)){
lonv <- sum(table1[i,1])
commonk[j,i] <- log10(0.1 + frec[j]/(lonv[i]-2))
}
}
return(commonk)
}
Fraccional_common <- Fractional(salida,min_lon)
View(Fraccional_common)
Fractional <- function(table, table1, k=3){
commonk <- data.frame()
frec <- vector()
lonv <- vector()
for(j in 1:nrow(table)){
frec <- sum(table[j,])
for(i in 1:nrow(table1)){
lonv <- sum(table1[i,1])
commonk[j,1] <- log10(0.1 + frec[j]/(lonv[i]-2))
}
}
return(commonk)
}
Fraccional_common <- Fractional(salida,min_lon)
View(Fraccional_common)
nrow(salida)
nrow(min_lon)
Fractional <- function(table, table1, k=3){
commonk <- data.frame()
frec <- vector()
lonv <- vector()
for(j in 1:nrow(table)){
frec <- sum(table[j,])
}
for(i in 1:nrow(table1)){
lonv <- sum(table1[i,1])
}
commonk[j,i] <- log10(0.1 + frec[j]/(lonv[i]-2))
return(commonk)
}
Fraccional_common <- Fractional(salida,min_lon)
Fractional <- function(table, table1, k=3){
commonk <- data.frame()
frec <- vector()
lonv <- vector()
for(j in 1:nrow(table)){
frec <- sum(table[j,])
for(i in 1:nrow(table1)){
lonv <- sum(table1[i,1])
commonk[j,i] <- log10(0.1 + frec[j]/(lonv[i]-2))
}
}
return(commonk)
}
Fraccional_common <- Fractional(salida,min_lon)
View(Fraccional_common)
length(min_lon)
length(salida)
Fractional <- function(table, table1, k=3){
commonk <- data.frame()
frec <- vector()
lonv <- vector()
for(j in 1:nrow(table)){
frec <- sum(table[j,])
for(i in 1:nrow(table1)){
lonv <- sum(table1[i,1])
}
commonk[j,i] <- log10(0.1 + frec[j]/(lonv[i]-2))
}
return(commonk)
}
Fraccional_common <- Fractional(salida,min_lon)
Fractional <- function(table, table1, k=3){
commonk <- data.frame()
frec <- vector()
lonv <- vector()
for(j in 1:nrow(table)){
frec <- sum(table[j,])
for(i in 1:nrow(table1)){
lonv <- sum(table1[i,1])
commonk[j,i] <- c(log10(0.1 + frec[j]/(lonv[i]-2)))
}
}
return(commonk)
}
Fraccional_common <- Fractional(salida,min_lon)
View(Fraccional_common)
Fractional <- function(table, table1, k=3){
commonk <- data.frame()
frec <- vector()
lonv <- vector()
for(j in 1:nrow(table)){
frec <- sum(table[j,])
for(i in 1:nrow(table1)){
lonv <- sum(table1[i,1])
commonk[j,i] <- c(commonk, log10(0.1 + frec[j]/(lonv[i]-2)))
}
}
return(commonk)
}
Fraccional_common <- Fractional(salida,min_lon)
View(Fraccional_common)
warnings()
Fractional <- function(table,table1,k=3){
commonk<- data.frame()
for(j in 1:nrow(table)){
for(i in 1:nrow(table1)){
commonk[j,1] <- (log10(0.1 + sum(table[j,]/(table1[i,1]-2))))
}
}
return(commonk)
}
Fraccional_common <- Fractional(salida,min_lon)
Fractional <- function(table,table1,k=3){
commonk<- data.frame()
for(j in 1:nrow(table)){
for(i in 1:nrow(table1)){
commonk[j,1] <- sum(table[j,]/(table1[i,1]-2))
}
}
return(commonk)
}
Fraccional_common <- Fractional(salida,min_lon)
Fractional <- function(table,table1,k=3){
commonk<- data.frame()
for(j in 1:nrow(table)){
for(i in 1:nrow(table1)){
commonk[j,i] <- sum(table[j,]/(table1[i,1]-2))
}
}
return(commonk)
}
Fraccional_common <- Fractional(salida,min_lon)
Fractional <- function(table, table1, k=3){
commonk <- data.frame()
frec <- vector()
lonv <- vector()
for(j in 1:nrow(table)){
frec <- sum(table[j,])
for(i in 1:nrow(table1)){
lonv <- sum(table1[i,1])
commonk[j,i] <- frec[j]/(lonv[i]-2)
}
}
return(commonk)
}
Fraccional_common <- Fractional(salida,min_lon)
View(Fraccional_common)
Fractional <- function(table, table1, k=3){
commonk <- data.frame()
frec <- vector()
lonv <- vector()
for(j in 1:nrow(table)){
frec <- sum(table[j,])
for(i in 1:nrow(table1)){
lonv <- sum(table1[i,])
commonk[j,i] <- log10(0.1 + frec[j]/(lonv[i]-2))
}
}
return(commonk)
}
Fraccional_common <- Fractional(salida,min_lon)
View(Fraccional_common)
nrow(salida)
1:nrow(salida)
Fractional <- function(table, table1, k=3){
commonk <- data.frame()
frec <- vector()
lonv <- vector()
for(j in 1:nrow(table)){
frec <- sum(table[j,])
for(i in 1:nrow(table)){
lonv <- sum(table1[i,])
commonk[j,i] <- log10(0.1 + frec[j]/(lonv[i]-2))
}
}
return(commonk)
}
Fraccional_common <- Fractional(salida,min_lon)
View(Fraccional_common)
Fractional <- function(table, table1, k=3){
commonk <- data.frame()
frec <- vector()
lonv <- vector()
for(j in 1:nrow(table)){
frec <- sum(table[j,])
for(i in 1:nrow(table)){
lonv <- sum(table1[i,])
commonk[j,i] <- log10(0.1 + frec[j]/(lonv[i]-2))
}
}
return(commonk)
}
Fraccional_common <- Fractional(salida)
Fractional <- function(table, table1, k=3){
commonk <- data.frame()
frec <- vector()
lonv <- vector()
for(j in 1:nrow(table)){
frec <- sum(table[j,])
for(i in 1:nrow(table)){
lonv <- sum(table[i,])
commonk[j,i] <- log10(0.1 + frec[j]/(lonv[i]-2))
}
}
return(commonk)
}
Fraccional_common <- Fractional(salida)
Fractional <- function(table,table1,k=3){
commonk<- data.frame()
for(j in 1:nrow(table)){
for(i in 1:nrow(table)){
commonk[j,i] <- (log10(0.1 + sum(table[j,]/(table[i,1]-2))))
}
}
return(commonk)
}
Fraccional_common <- Fractional(salida)
Fractional <- function(table,table1,k=3){
commonk<- data.frame()
for(j in 1:nrow(table)){
for(i in 1:nrow(table1)){
commonk[j,i] <- (log10(0.1 + sum(table[j,]/(table1[i,1]-2))))
}
}
return(commonk)
}
Fraccional_common <- Fractional(salida,min_lon)
Fractional <- function(table,table1,k=3){
}
Fractional <- function(table,table1,k=3){
commonk<- data.frame()
for(j in 1:nrow(table)){
for(i in 1:nrow(table1)){
commonk[j,i] <- (log10(0.1 + sum(table[j,]/(table1[i,1]-2))))
}
}
return(commonk)
}
Fraccional_common <- Fractional(salida,min_lon)
Fractional <- function(table,table1,k=3){
commonk<- data.frame()
for(j in 1:nrow(table)){
for(i in 1:nrow(table1)){
commonk[j,i] <- (log10(0.1 + sum(table[j,]/(table1[i,1]-2))))
}
}
return(commonk)
}
Fraccional_common <- Fractional(salida,min_lon)
View(Fraccional_common)
Fractional <- function(table, table1, k=3){
commonk <- data.frame()
frec <- vector()
lonv <- vector()
for(j in 1:nrow(table)){
frec <- sum(table[j,])
for(i in 1:nrow(table1)){
lonv <- sum(table1[i,])
commonk[j,i] <- log10(0.1 + frec[j]/(lonv[i]-2))
}
}
return(commonk)
}
dat_seq <- read.table(file = "seq_cosmo.txt", header= T, sep=" ")
Fractional <- function(table, table1, k=3){
commonk <- data.frame()
frec <- vector()
lonv <- vector()
for(j in 1:nrow(table)){
frec <- sum(table[j,])
for(i in 1:nrow(table1)){
lonv <- sum(table1[i,])
commonk[j,i] <- log10(0.1 + frec[j]/(lonv[i]-2))
}
}
return(commonk)
}
Fraccional_common <- Fractional(salida,min_lon)
View(Fraccional_common)
Fractional <- function(table, table1, k=3){
commonk <- data.frame()
frec <- vector()
lonv <- vector()
for(j in 1:nrow(table)){
frec <- sum(table[j,])
for(i in 1:nrow(table1)){
lonv <- sum(table1[i,])
commonk[j,i] <- log(0.1 + frec[j]/(lonv[i]-2))
}
}
return(commonk)
}
Fraccional_common <- Fractional(salida,min_lon)
View(Fraccional_common)
log10(0.1 + sum(salida[5,]/(min_lon[5,1]-2)))
log10(0.1 + sum(salida[10,]/(min_lon[10,1]-2)))
log(0.1 + sum(salida[10,]/(min_lon[10,1]-2)))
Fractional <- function(table, table1, k=3){
commonk <- data.frame()
frec <- vector()
lonv <- vector()
for(j in 1:nrow(table)){
frec <- sum(table[j,])
for(i in 1:nrow(table1)){
lonv <- sum(table1[i,])
commonk[j,i] <- log(0.1 + frec/(lonv-2))
}
}
return(commonk)
}
Fraccional_common <- Fractional(salida,min_lon)
View(Fraccional_common)
log(0)
105/15
length(Fraccional_common)
seq(1, 15, by= 1)
seq(1,7, by=7)
seq(1,7, by=1)
7*15
sal <- data.frame(NA)
for(i in 1:7){
for(d in 1:15){
sal[d,d+1] <- Fraccional_common[d*i,]
}
}
warnings()
sal
Fractional <- function(table, table1, k=3){
commonk <- data.frame()
frec <- vector()
lonv <- vector()
for(j in 1:nrow(table)){
frec <- sum(table[j,])
lonv <- sum(table1[j,])
commonk[j] <- log(0.1 + frec/(lonv-2))
}
return(commonk)
}
length(Fraccional_common)
Fraccional_common <- Fractional(salida,min_lon)
Fractional <- function(table, table1, k=3){
commonk <- vector()
frec <- vector()
lonv <- vector()
for(j in 1:nrow(table)){
frec <- sum(table[j,])
lonv <- sum(table1[j,])
commonk[j] <- log(0.1 + frec/(lonv-2))
}
return(commonk)
}
Fractional <- function(table, table1, k=3){
commonk <- vector()
frec <- vector()
lonv <- vector()
for(j in 1:nrow(table)){
frec <- sum(table[j,])
lonv <- sum(table1[j,])
commonk[j] <- log(0.1 + frec/(lonv-2))
}
return(commonk)
}
Fraccional_common <- Fractional(salida,min_lon)
Fractional <- function(table, table1, k=3){
commonk <- data.frame()
frec <- vector()
lonv <- vector()
for(j in 1:nrow(table)){
frec <- sum(table[j,])
lonv <- sum(table1[j,])
commonk[j,1] <- log(0.1 + frec/(lonv-2))
}
return(commonk)
}
Fraccional_common <- Fractional(salida,min_lon)
View(Fraccional_common)
seq(1, 15, by= 1)
tabla <- read.csv(file = "/home/andrea/Descargas/Compendio_datos_total-csv.csv")
View(tabla)
otro <-  read.csv(file = "/home/andrea/LSB/Piloto_Dengue/data/Base_Datos_Dengue_2016/Compendio_datos_total-csv.csv")
View(otro)
View(overlap)
sequences_dengue <- read.csv(file = "/home/andrea/LSB/Piloto_Dengue/bin/descargar CDS r/Dengue_18")
View(sequences_dengue)
db_gc <-  read.csv(file = "/home/andrea/LSB/Piloto_Dengue/data/Base_Datos_Dengue_2016/bd_genoma_completo.csv")
ID <- db_gc$N_Accesion
ID <- ID[-c(103, 163, 164, 165)]
ID <- ID[-c(472:495)]
which(ID == "JQ045686")
ID[3310]
ID[3311]
ID[3312]
ID[3313]
ID[3314]
ID[3315]
ID[3316]
ID[3317]
ID[3318]
ID[3319]
ID[3320]
ID[3321]
ID[3322]
ID[3323]
ID[3324]
ID[3325]
ID[3326]
ID[3327]
ID[3328]
ID[3329]
ID[3330]
ID[3331]
downloadCDSgb<-function(No.Accesion= NULL,save.fasta=NULL ){
require("seqinr")
require('ape')
out<-file(save.fasta,open = 'w')
for (i in 1:length(No.Accesion)){
choosebank("genbank")
gb <- query("gb", paste('N=',No.Accesion[i],sep=''))
annotations <- getAnnot(gb$req[[1]])
cds<-grep(pattern ='CDS',annotations )
cds<-sub(pattern ='*CDS. *',replacement = '',annotations[cds])
cds<-gsub("[[:space:]]",'',cds)
initial<-strsplit(gsub("[..]",' ',cds),split =' ')[[1]][1]
final<-strsplit(gsub("[..]",' ',cds),split =' ')[[1]][3]
closebank()
seque<-read.GenBank(access.nb = No.Accesion[i],
species.names = T,gene.names = F,
as.character = T)
seque[[1]]<-seque[[1]][initial:final]
name.sp<-as.character(attr(seque,'species'))
name.id<-as.character(names(seque))
names(seque)<-paste(name.sp,name.id,sep='_')
cat.seque<-paste(seque[[1]],collapse ='' )
writeLines(paste('>',names(seque),sep=''),out,sep='\n')
writeLines(cat.seque,out,sep='\n')
}
close(out)
}
ID <- ID[c(3312,3326)]
length(ID)
downloadCDSgb(No.Accesion = ID,save.fasta = 'Dengue_20')
sequences_dengue <- read.csv(file = "/home/andrea/LSB/Piloto_Dengue/bin/descargar CDS r/Dengue_20")
setwd("/home/andrea/LSB//Piloto_Dengue/bin/descargar CDS r")
library(ape)
library(seqinr)
source('downloadCDSgb.R')
length(ID)
downloadCDSgb(No.Accesion = ID,save.fasta = 'Dengue_20')
sequences_dengue <- read.csv(file = "/home/andrea/LSB/Piloto_Dengue/bin/descargar CDS r/Dengue_20")
View(sequences_dengue)
sequences_dengue <- read.csv(file = "/home/andrea/LSB/Piloto_Dengue/bin/descargar CDS r/Dengue_19")
View(sequences_dengue)
which(ID == "JQ045628")
db_gc <-  read.csv(file = "/home/andrea/LSB/Piloto_Dengue/data/Base_Datos_Dengue_2016/bd_genoma_completo.csv")
ID <- db_gc$N_Accesion
ID <- ID[-c(103, 163, 164, 165)]
ID <- ID[-c(472:495)]
which(ID == "JQ045628")
ID(3368)
ID[3368]
ID[3369]
ID[3370]
ID[3371]
ID[3372]
which(ID == "JQ045628")
sequences_dengue <- read.csv(file = "/home/andrea/LSB/Piloto_Dengue/bin/descargar CDS r/Dengue_20")
View(sequences_dengue)
which(ID == "AY648961")
ID[3552]
ID[3553]
ID[3554]
sequences_dengue <- read.csv(file = "/home/andrea/LSB/Piloto_Dengue/bin/descargar CDS r/Dengue_21")
ID[3554]
ID[3555]
sequences_dengue <- read.csv(file = "/home/andrea/LSB/Piloto_Dengue/bin/descargar CDS r/Dengue_21")
View(sequences_dengue)
which(ID == "AF180817")
ID[3768]
ID[3769]
ID[3770]
ID[3771]
which(ID == "AF180817")
ID[3772]
which(ID == "AF180817")
